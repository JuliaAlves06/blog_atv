{
  "hash": "841a4e1f2b042cb1f96f69109594f6be",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Atividade 2\"\nauthor: \"Julia\"\ndate: \"2025-11-24\"\ncategories: [python, código]\nimage: \"frota.png\"\njupyter: python3\n---\n\nAbaixo terá o código da atividade 2 com o código explicado em comentários.\n\n::: {#aeec1fbb .cell execution_count=1}\n``` {.python .cell-code}\nimport requests\nimport folium\nimport json\n\n# Etapa 1: Definições iniciais\nAPI_TOKEN = \"d1a401756017d338d7952e806dbba6d718d09c130a6261fd2b25bc2bb5b5a079\"\ncodigo_linha = \"709EX1\"\n\n# Etapa 2: Autenticação na API\nsessao = requests.Session()\nurl_login = f\"http://api.olhovivo.sptrans.com.br/v2.1/Login/Autenticar?token={API_TOKEN}\"\nlogin = sessao.post(url_login)\n\nif login.status_code == 200 and login.json() is True:\n    print(\"Login realizado com sucesso!\")\nelse:\n    print(\"Falha na autenticação. Confira o token.\")\n\n# Etapa 3: Obter paradas da linha\nurl_paradas = f\"http://api.olhovivo.sptrans.com.br/v2.1/ParadaLinha?codigoLinha={codigo_linha}\"\ndados_paradas = sessao.get(url_paradas).json()\nif isinstance(dados_paradas, str):\n    dados_paradas = json.loads(dados_paradas)\nelif isinstance(dados_paradas, dict) and \"value\" in dados_paradas:\n    dados_paradas = dados_paradas[\"value\"]\n\n# Etapa 4: Posições dos ônibus em tempo real\nurl_onibus = f\"http://api.olhovivo.sptrans.com.br/v2.1/Posicao?codigoLinha={codigo_linha}\"\ndados_onibus = sessao.get(url_onibus).json()\nif isinstance(dados_onibus, str):\n    dados_onibus = json.loads(dados_onibus)\nelif isinstance(dados_onibus, dict) and \"value\" in dados_onibus:\n    dados_onibus = dados_onibus[\"value\"]\n\n# Etapa 5: Trajeto da linha\nurl_trajeto = f\"http://api.olhovivo.sptrans.com.br/v2.1/Linha/Trajeto?codigoLinha={codigo_linha}\"\ndados_trajeto = sessao.get(url_trajeto).json()\nif isinstance(dados_trajeto, str):\n    dados_trajeto = json.loads(dados_trajeto)\nelif isinstance(dados_trajeto, dict) and \"value\" in dados_trajeto:\n    dados_trajeto = dados_trajeto[\"value\"]\n\n# Extrair coordenadas do trajeto\ncoords_trajeto = []\nif isinstance(dados_trajeto, list):\n    for ponto in dados_trajeto:\n        if \"Latitude\" in ponto and \"Longitude\" in ponto:\n            coords_trajeto.append([ponto[\"Latitude\"], ponto[\"Longitude\"]])\n\n# Etapa 6: Construção do mapa\nmapa = folium.Map(location=[-23.55, -46.63], zoom_start=12)\n\n# Adicionar trajeto (linha verde)\nif coords_trajeto:\n    folium.PolyLine(coords_trajeto, color=\"green\", weight=4, opacity=0.6,\n                    tooltip=\"Percurso da linha\").add_to(mapa)\n\n# Adicionar paradas (azul)\nif isinstance(dados_paradas, list):\n    for parada in dados_paradas:\n        if \"Latitude\" in parada and \"Longitude\" in parada:\n            folium.Marker(\n                location=[parada[\"Latitude\"], parada[\"Longitude\"]],\n                popup=f\"Parada: {parada.get('Denominacao', 'Sem nome')}\",\n                icon=folium.Icon(color=\"blue\", icon=\"info-sign\")\n            ).add_to(mapa)\n\n# Adicionar ônibus em tempo real (vermelho)\nif isinstance(dados_onibus, dict) and \"vs\" in dados_onibus:\n    for veiculo in dados_onibus[\"vs\"]:\n        folium.Marker(\n            location=[veiculo[\"py\"], veiculo[\"px\"]],\n            popup=f\"Prefixo: {veiculo['p']}\",\n            icon=folium.Icon(color=\"red\", icon=\"bus\", prefix=\"fa\")\n        ).add_to(mapa)\n\n# Etapa 7: Exportar mapa\nmapa.save(\"linha_onibus.html\")\nprint(\"Mapa pronto: abra 'linha_onibus.html' no navegador.\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLogin realizado com sucesso!\nMapa pronto: abra 'linha_onibus.html' no navegador.\n```\n:::\n:::\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {}
  }
}